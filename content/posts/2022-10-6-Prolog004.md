---
author: "Naptax"
title: "PROLOG 0x004, Local Shellcode par Stack Buffer OverFlow (Part 2) "
date: "2022-09-26"
tags: 
- prolog
- bof
---

<center>
<img width="150" src="/images/ptitfantome.png">
</center>

Hello,

Toujours dans cette série de billets d'ouverture (aka PROLOG), nous nous étions laissés la derniere fois sur un billet expliquant ce qu'était un BUFFER OVERFLOW (le billet est ici). Je vous propose maintenant de passer à la pratique en obtenant un Shell par l'utilisation d'un STACK Buffer Overflow.

Toujours dans un soucis de pédagogie, nous allons prendre un exemple simple :
- Une erreur de programmation flagrante
- Un executable ne disposant d'aucun moyen de protection de sa stack 
- Un OS pour lequel nous aurions désactivé l'ADSLR qui le protège de ce type d'exploitation

Un peu plus tard, nous verons que ces moyens de protection, meme activés, sont eux aussi 'bypassable' ...

Je ne ferai pas de rappel théorique dans ce billet, pour celà je vous renvoie aux billets PROLOG précédants.


# Le principe de base du Stack Buffer Overflow
Un peu d'histoire et de remerciements .....

Le principe de base consiste donc à venir écraser la valeur présente à l'adresse de retour lors de l'appel d'une fonction.
Cette valeur d'EIP/RIP ayant été préalablement (et automatiquement) sauvegardée sur la pile au moment du CALL de cette fonction. La sauvegarde automatique par l'instruction CALL de cette valeur est nécéssaire afin de pouvoir rebrancher le flux d'éxécution une fois l'éxécution de la fonction terminée. "Bah Oui, je vais où maintenant demande le processeur ? ;-)

Plus précisément, nous souhaitons REMPLACER/SUBSITUER cette valeur (une adresse mémoire) par une une autre adresse; adresse sur laquelle nous aurions préalablement 'posé' notre Shellcode (ou tout autre forme de Payload).

Donc, nous allons profiter de pouvoir écrire au delà de la taille attendue (cf le Billet sur le Buffer Overflow), pour poser une chaine de caractères qui sera exécutée par le processeur.

# Le vilain programme

# Comment déterminer cette adresse ?
Il existe plusieurs techniques pour trouver cette adresse, je v